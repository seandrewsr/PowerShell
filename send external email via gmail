# send external email via gmail

# Set-ExecutionPolicy Unrestricted


cls

$username = 'first.last@gamil.com' # this is your gmail username
$password = 'ixogpynxrazybjzl' # this is an app password code generated by google
$secstr = New-Object -TypeName System.Security.SecureString # initiate secure string for the password
$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)} # secure string encrypt the password
$recipient_array = @("firstname.lastname@somacompany.com")
$bcc_recipient_array = @("firstname.lastname@somacompany.com")

$hash = @{
  from = "first.last@gamil.com"
  to = $recipient_array
  bcc = $bcc_recipient_array
  subject = "automated from gmail/powershell test"
  smtpserver = "smtp.gmail.com"
  port = "587"
  body = "this is a test automated email from gmail generated via powershell"
  credential = New-Object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr
  usessl = $true
  verbose = $true
}

Try
{
  Send-MailMessage @hash
  Write-Host "message sent" -ForegroundColor Blue -BackgroundColor Yellow
}
Catch
{
  Write-Host "Danger Will Robinson" -ForegroundColor Blue -BackgroundColor Yellow
  Write-Host "The error message" -ForegroundColor Yellow
  Write-Host [$($_.Exception.Message) -ForegroundColor Red -BackgroundColor DarkBlue
}



